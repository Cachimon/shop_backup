(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-516b9052"],{"0140":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"add"},[o("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[o("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[t._v("首页")]),o("el-breadcrumb-item",[t._v("商品管理")]),o("el-breadcrumb-item",[t._v("修改商品")])],1),o("el-card",{staticClass:"box-card"},[o("el-alert",{attrs:{title:"添加商品信息",type:"info","show-icon":"",closable:!1,center:""}}),o("el-steps",{staticClass:"add-steps",staticStyle:{"font-size":"12px"},attrs:{active:t.activeIndex-0,"finish-status":"success","align-center":""}},[o("el-step",{attrs:{title:"基本信息"}}),o("el-step",{attrs:{title:"商品参数"}}),o("el-step",{attrs:{title:"商品属性"}}),o("el-step",{attrs:{title:"商品图片"}}),o("el-step",{attrs:{title:"商品内容"}}),o("el-step",{attrs:{title:"完成"}})],1),o("el-form",{ref:"addRef",attrs:{model:t.addGoodsInfo,rules:t.addGoodsRules,"label-width":"100px","label-position":"top"}},[o("el-tabs",{attrs:{"tab-position":"left","before-leave":t.beforeTabLeave},on:{"tab-click":t.tabClick},model:{value:t.activeIndex,callback:function(e){t.activeIndex=e},expression:"activeIndex"}},[o("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[o("el-form-item",{attrs:{label:"商品名称：",prop:"goods_name"}},[o("el-input",{model:{value:t.addGoodsInfo.goods_name,callback:function(e){t.$set(t.addGoodsInfo,"goods_name",e)},expression:"addGoodsInfo.goods_name"}})],1),o("el-form-item",{attrs:{label:"商品价格：",prop:"goods_price"}},[o("el-input",{model:{value:t.addGoodsInfo.goods_price,callback:function(e){t.$set(t.addGoodsInfo,"goods_price",e)},expression:"addGoodsInfo.goods_price"}})],1),o("el-form-item",{attrs:{label:"商品重量：",prop:"goods_weight"}},[o("el-input",{attrs:{type:"number"},model:{value:t.addGoodsInfo.goods_weight,callback:function(e){t.$set(t.addGoodsInfo,"goods_weight",e)},expression:"addGoodsInfo.goods_weight"}})],1),o("el-form-item",{attrs:{label:"商品数量：",prop:"goods_number"}},[o("el-input",{attrs:{type:"number"},model:{value:t.addGoodsInfo.goods_number,callback:function(e){t.$set(t.addGoodsInfo,"goods_number",e)},expression:"addGoodsInfo.goods_number"}})],1),o("el-form-item",{attrs:{label:"商品分类：",prop:"goods_cat"}},[o("el-cascader",{staticStyle:{position:"relative"},attrs:{options:t.cateList,props:t.cateProps,clearable:""},model:{value:t.addGoodsInfo.goods_cat,callback:function(e){t.$set(t.addGoodsInfo,"goods_cat",e)},expression:"addGoodsInfo.goods_cat"}})],1)],1),o("el-tab-pane",{attrs:{label:"商品参数",name:"1"}},t._l(t.manyAttrList,(function(e,a){return o("el-form-item",{key:e.attr_id,attrs:{label:e.attr_name,prop:"attr_value"}},[o("el-checkbox-group",{model:{value:e.attr_vals,callback:function(o){t.$set(e,"attr_vals",o)},expression:"item.attr_vals"}},t._l(e.attr_vals,(function(t,e){return o("el-checkbox",{attrs:{label:t,border:""}})})),1)],1)})),1),o("el-tab-pane",{attrs:{label:"商品属性",name:"2"}},t._l(t.onlyAttrList,(function(e,a){return o("el-form-item",{attrs:{label:e.attr_name}},[o("el-input",{model:{value:e.attr_vals,callback:function(o){t.$set(e,"attr_vals",o)},expression:"item.attr_vals"}})],1)})),1),o("el-tab-pane",{attrs:{label:"商品图片",name:"3"}},[o("el-upload",{attrs:{headers:t.imgUploadHeaders,action:t.uploadPathPrefix+"upload","on-preview":t.imgPreview,"on-remove":t.imgRemove,"file-list":t.imgList,"list-type":"picture","on-success":t.imgUploadSuccess}},[o("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1)],1),o("el-tab-pane",{attrs:{label:"商品内容",name:"4"}},[o("quill-editor",{model:{value:t.addGoodsInfo.goods_introduce,callback:function(e){t.$set(t.addGoodsInfo,"goods_introduce",e)},expression:"addGoodsInfo.goods_introduce"}})],1),o("el-tab-pane",{attrs:{label:"完成",name:"5"}},[o("el-alert",{attrs:{title:"添加商品成功，"+t.timeOut+"s后将跳转到商品页面",type:"success","show-icon":"",closable:!1}})],1)],1)],1),o("div",{staticClass:"step-btn"},[o("el-button",{attrs:{type:"primary",disabled:"0"===t.activeIndex},on:{click:t.lastStep}},[t._v("上一步")]),t.activeIndex<4?o("el-button",{attrs:{type:"primary"},on:{click:t.nextStep}},[t._v("下一步")]):o("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("添加商品")])],1)],1),o("el-dialog",{attrs:{title:"图片预览",visible:t.showImgPreview,width:"50%"},on:{"update:visible":function(e){t.showImgPreview=e}}},[o("img",{attrs:{src:t.imgPreviewSrc,alt:""}})])],1)},n=[],r=(o("c740"),o("4160"),o("a15b"),o("a434"),o("ac1f"),o("1276"),o("159b"),o("2ef0")),i={data:function(){return{goodsID:0,uploadPathPrefix:"http://localhost:8888/api/private/v1/",imgPathPrefix:"http://localhost:8888/",activeIndex:0,addGoodsInfo:{goods_name:"",goods_price:"",goods_number:"",goods_weight:"",goods_cat:[],goods_introduce:"",pics:[],attrs:[]},addGoodsRules:{goods_name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],goods_price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],goods_number:[{required:!0,message:"请输入商品重量",trigger:"blur"}],goods_weight:[{required:!0,message:"请输入商品数量",trigger:"blur"}],goods_cat:[{required:!0,message:"请选择商品分类",trigger:"blur"}]},cateProps:{expandTrigger:"hover",value:"cat_id",label:"cat_name",children:"children"},cateList:[],onlyAttrList:[],manyAttrList:[],imgUploadHeaders:{Authorization:window.sessionStorage.getItem("token")},imgList:[],showImgPreview:!1,imgPreviewSrc:"",ifSumited:!1,timeOut:3}},created:function(){this.getCateList(),this.addGoodsInfo.pics=[],this.getGoodsInfo()},methods:{getGoodsInfo:function(){var t=this;this.goodsID=this.$route.params.id,this.$http.get("goods/".concat(this.goodsID)).then((function(e){if(console.log(e),200!==e.data.meta.status)return t.$message.error("获取商品信息失败");var o=e.data.data;t.addGoodsInfo.goods_name=o.goods_name,t.addGoodsInfo.goods_price=o.goods_price,t.addGoodsInfo.goods_number=o.goods_number,t.addGoodsInfo.goods_weight=o.goods_weight,t.addGoodsInfo.goods_introduce=o.goods_introduce,t.addGoodsInfo.goods_pics=o.goods_pics,t.addGoodsInfo.goods_cat=[o.cat_one_id],o.cat_two_id&&t.addGoodsInfo.goods_cat.push(o.cat_two_id),o.cat_three_id&&t.addGoodsInfo.goods_cat.push(o.cat_three_id)}))},getCateList:function(){var t=this;this.$http.get("categories").then((function(e){if(200!==e.data.meta.status)return t.$message.error("获取分类列表失败");t.cateList=e.data.data}))},lastStep:function(){this.activeIndex=this.activeIndex-1+""},beforeTabLeave:function(t,e){return"0"===this.activeIndex&&0===this.addGoodsInfo.goods_cat.length?(this.$message.error("请选择分类列表"),!1):"5"!==t||this.ifSumited?void 0:(this.$message.error("请先提交商品信息"),!1)},nextStep:function(){if("0"===this.activeIndex&&0===this.addGoodsInfo.goods_cat.length)return this.$message.error("请选择分类列表");this.activeIndex=this.activeIndex-0+1+"";this.activeIndex},nextStepMethod:function(t){var e=this;1===t?0===this.manyAttrList.length&&this.$http.get("categories/".concat(this.addGoodsInfo.goods_cat[this.addGoodsInfo.goods_cat.length-1],"/attributes"),{params:{sel:"many"}}).then((function(t){if(200!==t.data.meta.status)return e.$message.error("获取参数失败");t.data.data.forEach((function(t){t.attr_vals=(t.attr_vals||" ").split(" "),t.showAddTagInput=!1,t.newTag=""})),e.manyAttrList=t.data.data})).catch((function(t){return t})):2===t&&0===this.onlyAttrList.length&&this.$http.get("categories/".concat(this.addGoodsInfo.goods_cat[this.addGoodsInfo.goods_cat.length-1],"/attributes"),{params:{sel:"only"}}).then((function(t){if(200!==t.data.meta.status)return e.$message.error("获取属性失败");e.onlyAttrList=t.data.data})).catch((function(t){return t}))},tabClick:function(){this.activeIndex},imgPreview:function(t){this.imgPreviewSrc=this.imgPathPrefix+t.response.data.tmp_path,this.showImgPreview=!0},imgRemove:function(t,e){var o=t.response.data.tmp_path,a=this.addGoodsInfo.pics.findIndex((function(t){return t.pic===o}));this.addGoodsInfo.pics.splice(a,1)},imgUploadSuccess:function(t){var e={pic:t.data.tmp_path};this.addGoodsInfo.pics.push(e)},submit:function(){var t=this;this.$refs.addRef.validate((function(e){if(!e)return t.$message.error("请完成填写相关项");var o=r.clone(t.addGoodsInfo);o.goods_cat=o.goods_cat.join(","),t.manyAttrList.forEach((function(t){var e={attr_id:t.attr_id,attr_value:t.attr_vals.join(" ")};o.attrs.push(e)})),t.onlyAttrList.forEach((function(t){var e={attr_id:t.attr_id,attr_value:t.attr_vals};o.attrs.push(e)})),t.$http.post("goods",o).then((function(e){if(201!==e.data.meta.status)return t.$message.error("添加商品失败");t.ifSumited=!0,t.activeIndex="5";var o=setInterval((function(){t.timeOut--,t.timeOut<=1&&(clearInterval(o),t.$router.push("/goods"))}),1e3)}))}))}}},s=i,c=(o("a99c"),o("2877")),l=Object(c["a"])(s,a,n,!1,null,"39891573",null);e["default"]=l.exports},1276:function(t,e,o){"use strict";var a=o("d784"),n=o("44e7"),r=o("825a"),i=o("1d80"),s=o("4840"),c=o("8aa5"),l=o("50c4"),d=o("14c3"),u=o("9263"),f=o("d039"),g=[].push,p=Math.min,h=4294967295,m=!f((function(){return!RegExp(h,"y")}));a("split",2,(function(t,e,o){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,o){var a=String(i(this)),r=void 0===o?h:o>>>0;if(0===r)return[];if(void 0===t)return[a];if(!n(t))return e.call(a,t,r);var s,c,l,d=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,m=new RegExp(t.source,f+"g");while(s=u.call(m,a)){if(c=m.lastIndex,c>p&&(d.push(a.slice(p,s.index)),s.length>1&&s.index<a.length&&g.apply(d,s.slice(1)),l=s[0].length,p=c,d.length>=r))break;m.lastIndex===s.index&&m.lastIndex++}return p===a.length?!l&&m.test("")||d.push(""):d.push(a.slice(p)),d.length>r?d.slice(0,r):d}:"0".split(void 0,0).length?function(t,o){return void 0===t&&0===o?[]:e.call(this,t,o)}:e,[function(e,o){var n=i(this),r=void 0==e?void 0:e[t];return void 0!==r?r.call(e,n,o):a.call(String(n),e,o)},function(t,n){var i=o(a,t,this,n,a!==e);if(i.done)return i.value;var u=r(t),f=String(this),g=s(u,RegExp),v=u.unicode,b=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(m?"y":"g"),_=new g(m?u:"^(?:"+u.source+")",b),x=void 0===n?h:n>>>0;if(0===x)return[];if(0===f.length)return null===d(_,f)?[f]:[];var I=0,y=0,S=[];while(y<f.length){_.lastIndex=m?y:0;var E,G=d(_,m?f:f.slice(y));if(null===G||(E=p(l(_.lastIndex+(m?0:y)),f.length))===I)y=c(f,y,v);else{if(S.push(f.slice(I,y)),S.length===x)return S;for(var w=1;w<=G.length-1;w++)if(S.push(G[w]),S.length===x)return S;y=I=E}}return S.push(f.slice(I)),S}]}),!m)},"14c3":function(t,e,o){var a=o("c6b6"),n=o("9263");t.exports=function(t,e){var o=t.exec;if("function"===typeof o){var r=o.call(t,e);if("object"!==typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==a(t))throw TypeError("RegExp#exec called on incompatible receiver");return n.call(t,e)}},"159b":function(t,e,o){var a=o("da84"),n=o("fdbc"),r=o("17c2"),i=o("9112");for(var s in n){var c=a[s],l=c&&c.prototype;if(l&&l.forEach!==r)try{i(l,"forEach",r)}catch(d){l.forEach=r}}},"17c2":function(t,e,o){"use strict";var a=o("b727").forEach,n=o("a640"),r=o("ae40"),i=n("forEach"),s=r("forEach");t.exports=i&&s?[].forEach:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}},4160:function(t,e,o){"use strict";var a=o("23e7"),n=o("17c2");a({target:"Array",proto:!0,forced:[].forEach!=n},{forEach:n})},"44e7":function(t,e,o){var a=o("861d"),n=o("c6b6"),r=o("b622"),i=r("match");t.exports=function(t){var e;return a(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==n(t))}},6547:function(t,e,o){var a=o("a691"),n=o("1d80"),r=function(t){return function(e,o){var r,i,s=String(n(e)),c=a(o),l=s.length;return c<0||c>=l?t?"":void 0:(r=s.charCodeAt(c),r<55296||r>56319||c+1===l||(i=s.charCodeAt(c+1))<56320||i>57343?t?s.charAt(c):r:t?s.slice(c,c+2):i-56320+(r-55296<<10)+65536)}};t.exports={codeAt:r(!1),charAt:r(!0)}},"8aa5":function(t,e,o){"use strict";var a=o("6547").charAt;t.exports=function(t,e,o){return e+(o?a(t,e).length:1)}},9263:function(t,e,o){"use strict";var a=o("ad6d"),n=o("9f7f"),r=RegExp.prototype.exec,i=String.prototype.replace,s=r,c=function(){var t=/a/,e=/b*/g;return r.call(t,"a"),r.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),l=n.UNSUPPORTED_Y||n.BROKEN_CARET,d=void 0!==/()??/.exec("")[1],u=c||d||l;u&&(s=function(t){var e,o,n,s,u=this,f=l&&u.sticky,g=a.call(u),p=u.source,h=0,m=t;return f&&(g=g.replace("y",""),-1===g.indexOf("g")&&(g+="g"),m=String(t).slice(u.lastIndex),u.lastIndex>0&&(!u.multiline||u.multiline&&"\n"!==t[u.lastIndex-1])&&(p="(?: "+p+")",m=" "+m,h++),o=new RegExp("^(?:"+p+")",g)),d&&(o=new RegExp("^"+p+"$(?!\\s)",g)),c&&(e=u.lastIndex),n=r.call(f?o:u,m),f?n?(n.input=n.input.slice(h),n[0]=n[0].slice(h),n.index=u.lastIndex,u.lastIndex+=n[0].length):u.lastIndex=0:c&&n&&(u.lastIndex=u.global?n.index+n[0].length:e),d&&n&&n.length>1&&i.call(n[0],o,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(n[s]=void 0)})),n}),t.exports=s},"9a33":function(t,e,o){},"9f7f":function(t,e,o){"use strict";var a=o("d039");function n(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=a((function(){var t=n("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=a((function(){var t=n("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},a15b:function(t,e,o){"use strict";var a=o("23e7"),n=o("44ad"),r=o("fc6a"),i=o("a640"),s=[].join,c=n!=Object,l=i("join",",");a({target:"Array",proto:!0,forced:c||!l},{join:function(t){return s.call(r(this),void 0===t?",":t)}})},a434:function(t,e,o){"use strict";var a=o("23e7"),n=o("23cb"),r=o("a691"),i=o("50c4"),s=o("7b0b"),c=o("65f0"),l=o("8418"),d=o("1dde"),u=o("ae40"),f=d("splice"),g=u("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,h=Math.min,m=9007199254740991,v="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!f||!g},{splice:function(t,e){var o,a,d,u,f,g,b=s(this),_=i(b.length),x=n(t,_),I=arguments.length;if(0===I?o=a=0:1===I?(o=0,a=_-x):(o=I-2,a=h(p(r(e),0),_-x)),_+o-a>m)throw TypeError(v);for(d=c(b,a),u=0;u<a;u++)f=x+u,f in b&&l(d,u,b[f]);if(d.length=a,o<a){for(u=x;u<_-a;u++)f=u+a,g=u+o,f in b?b[g]=b[f]:delete b[g];for(u=_;u>_-a+o;u--)delete b[u-1]}else if(o>a)for(u=_-a;u>x;u--)f=u+a-1,g=u+o-1,f in b?b[g]=b[f]:delete b[g];for(u=0;u<o;u++)b[u+x]=arguments[u+2];return b.length=_-a+o,d}})},a640:function(t,e,o){"use strict";var a=o("d039");t.exports=function(t,e){var o=[][t];return!!o&&a((function(){o.call(null,e||function(){throw 1},1)}))}},a99c:function(t,e,o){"use strict";var a=o("9a33"),n=o.n(a);n.a},ac1f:function(t,e,o){"use strict";var a=o("23e7"),n=o("9263");a({target:"RegExp",proto:!0,forced:/./.exec!==n},{exec:n})},ad6d:function(t,e,o){"use strict";var a=o("825a");t.exports=function(){var t=a(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},c740:function(t,e,o){"use strict";var a=o("23e7"),n=o("b727").findIndex,r=o("44d2"),i=o("ae40"),s="findIndex",c=!0,l=i(s);s in[]&&Array(1)[s]((function(){c=!1})),a({target:"Array",proto:!0,forced:c||!l},{findIndex:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),r(s)},d784:function(t,e,o){"use strict";o("ac1f");var a=o("6eeb"),n=o("d039"),r=o("b622"),i=o("9263"),s=o("9112"),c=r("species"),l=!n((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),d=function(){return"$0"==="a".replace(/./,"$0")}(),u=r("replace"),f=function(){return!!/./[u]&&""===/./[u]("a","$0")}(),g=!n((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var o="ab".split(t);return 2!==o.length||"a"!==o[0]||"b"!==o[1]}));t.exports=function(t,e,o,u){var p=r(t),h=!n((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),m=h&&!n((function(){var e=!1,o=/a/;return"split"===t&&(o={},o.constructor={},o.constructor[c]=function(){return o},o.flags="",o[p]=/./[p]),o.exec=function(){return e=!0,null},o[p](""),!e}));if(!h||!m||"replace"===t&&(!l||!d||f)||"split"===t&&!g){var v=/./[p],b=o(p,""[t],(function(t,e,o,a,n){return e.exec===i?h&&!n?{done:!0,value:v.call(e,o,a)}:{done:!0,value:t.call(o,e,a)}:{done:!1}}),{REPLACE_KEEPS_$0:d,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:f}),_=b[0],x=b[1];a(String.prototype,t,_),a(RegExp.prototype,p,2==e?function(t,e){return x.call(t,this,e)}:function(t){return x.call(t,this)})}u&&s(RegExp.prototype[p],"sham",!0)}},fdbc:function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}}}]);
//# sourceMappingURL=chunk-516b9052.0873878a.js.map