(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49d8d01a"],{"057f":function(e,t,r){var n=r("fc6a"),o=r("241c").f,i={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(e){try{return o(e)}catch(t){return s.slice()}};e.exports.f=function(e){return s&&"[object Window]"==i.call(e)?a(e):o(n(e))}},"0630":function(e,t,r){"use strict";r.r(t);var n,o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user"},[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("用户管理")]),r("el-breadcrumb-item",[e._v("用户列表")])],1),r("el-card",{staticClass:"box-card"},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容",clearable:""},on:{input:e.queryChange,clear:e.queryClose},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),r("el-col",{attrs:{span:6}},[r("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("添加用户")])],1)],1),r("el-table",{staticClass:"user-list-table",attrs:{data:e.userList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"index"}}),r("el-table-column",{attrs:{label:"姓名",prop:"username"}}),r("el-table-column",{attrs:{label:"邮箱",prop:"email"}}),r("el-table-column",{attrs:{label:"电话",prop:"mobile"}}),r("el-table-column",{attrs:{label:"角色",prop:"role_name"}}),r("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.userStateChanged(t.row)}},model:{value:t.row.mg_state,callback:function(r){e.$set(t.row,"mg_state",r)},expression:"scope.row.mg_state"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.editUser(t.row)}}}),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.removeUserById(t.row.id)}}}),r("el-tooltip",{attrs:{effect:"dark",content:"分配角色",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini"},on:{click:function(r){return e.setRole(t.row)}}})],1)]}}])})],1),r("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.queryInfo.pagesize,"page-sizes":[1,2,5,10],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{attrs:{title:"添加用户",visible:e.showAddUserForm,width:"50%"},on:{"update:visible":function(t){e.showAddUserForm=t}}},[r("el-form",{ref:"addUserRef",attrs:{model:e.addUserInfo,rules:e.addUserRules,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{model:{value:e.addUserInfo.username,callback:function(t){e.$set(e.addUserInfo,"username",t)},expression:"addUserInfo.username"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password"},model:{value:e.addUserInfo.password,callback:function(t){e.$set(e.addUserInfo,"password",t)},expression:"addUserInfo.password"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.addUserInfo.email,callback:function(t){e.$set(e.addUserInfo,"email",t)},expression:"addUserInfo.email"}})],1),r("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[r("el-input",{model:{value:e.addUserInfo.mobile,callback:function(t){e.$set(e.addUserInfo,"mobile",t)},expression:"addUserInfo.mobile"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.showAddUserForm=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.confirmAddUser}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"更新用户",visible:e.showEditForm,width:"50%"},on:{"update:visible":function(t){e.showEditForm=t}}},[r("el-form",{ref:"eiditRef",attrs:{model:e.editInfo,rules:e.editRules,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{attrs:{disabled:""},model:{value:e.editInfo.username,callback:function(t){e.$set(e.editInfo,"username",t)},expression:"editInfo.username"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.editInfo.email,callback:function(t){e.$set(e.editInfo,"email",t)},expression:"editInfo.email"}})],1),r("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[r("el-input",{model:{value:e.editInfo.mobile,callback:function(t){e.$set(e.editInfo,"mobile",t)},expression:"editInfo.mobile"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.showEditForm=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.confirmEdit(e.editInfo)}}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"分配角色",visible:e.showAssignRoleForm,width:"50%"},on:{"update:visible":function(t){e.showAssignRoleForm=t}}},[r("el-form",{staticClass:"role-form",attrs:{model:e.userInfo,"label-width":"96px"}},[r("p",[e._v("当前的用户："+e._s(e.userInfo.username))]),r("p",[e._v("当前的角色："+e._s(e.userInfo.roleName))]),r("p",[e._v(" 分配新角色： "),r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selectedRoleId,callback:function(t){e.selectedRoleId=t},expression:"selectedRoleId"}},e._l(e.rolesList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1)]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.showAssignRoleForm=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.confirmRole}},[e._v("确 定")])],1)],1)],1)},i=[];r("a4d3"),r("e01a"),r("d28b"),r("d3b7"),r("3ca3"),r("ddb0");function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a={data:function(){var e=function(e,t,r){var n=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/;if(n.test(t))return r();r(new Error("请输入合法的邮箱"))},t=function(e,t,r){var n=/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/;if(n.test(t))return r();r(new Error("请输入合法的手机号"))};return{query:"",userList:[],queryInfo:{query:"",pagenum:1,pagesize:2},total:0,timer:null,showAddUserForm:!1,addUserInfo:{username:"",password:"",email:"",mobile:""},addUserRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:10,message:"长度在 5 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:15,message:"长度在 6 到 15 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号码",trigger:"blur"},{validator:t,trigger:"blur"}]},showEditForm:!1,editInfo:{id:"",email:"",mobile:"",username:""},editRules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号码",trigger:"blur"},{validator:t,trigger:"blur"}]},showAssignRoleForm:!1,userInfo:{},rolesList:[],selectedRoleId:"",currentPage:1}},created:function(){this.getUserList()},methods:(n={getUserList:function(){var e=this;this.$http.get("users",{params:this.queryInfo}).then((function(t){var r=t.data;if(200!==r.meta.status)return e.$message.error("获取列表失败");e.total=r.data.total,e.userList=r.data.users})).catch((function(e){return e}))},queryChange:function(e){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){t.queryInfo.query=e,t.getUserList()}),1e3)},queryClose:function(){this.queryInfo.query=""},userStateChanged:function(e){var t=this;console.log(e.id),this.$http.put("users/"+e.id+"/state/"+e.mg_state,{params:{uId:e.id,type:!e.mg_state}}).then((function(e){if(200!==e.data.meta.status)return t.$message.error(e.data.meta.msg);t.$message.success(e.data.meta.msg),t.getUserList()})).catch((function(e){return e}))},addUser:function(){this.showAddUserForm=!0},confirmAddUser:function(){var e=this;this.$refs.addUserRef.validate((function(t){t&&e.$http.post("users",e.addUserInfo).then((function(t){if(console.log(t),201!==t.data.meta.status)return e.$message.error(t.data.meta.msg);e.$message.success("创建用户成功！"),e.showAddUserForm=!1,e.getUserList()})).catch((function(e){return e}))}))},confirmEdit:function(){console.log("confirm")},editUser:function(e){console.log(e),this.editInfo.id=e.id,this.editInfo.username=e.username,this.editInfo.email=e.email,this.editInfo.mobile=e.mobile,this.showEditForm=!0}},s(n,"confirmEdit",(function(e){var t=this;console.log(e),this.$refs.eiditRef.validate((function(r){r&&t.$http.put("users/"+e.id,{email:e.email,mobile:e.mobile}).then((function(e){if(200!==e.data.meta.status)return t.$message.error("res.data.meta.msg");t.$message.success("更新用户成功"),t.showEditForm=!1,t.getUserList()})).catch((function(e){return e}))}))})),s(n,"removeUserById",(function(e){var t=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$http.delete("users/"+e).then((function(e){if(console.log(e),200!==e.data.meta.status)return t.$message.error("删除失败");t.$message({type:"success",message:"删除成功!"}),t.getUserList()})).catch((function(e){return e}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))})),s(n,"setRole",(function(e){var t=this;this.$http.get("users/"+e.id).then((function(e){if(200!==e.data.meta.status)return t.$message.error("获取用户数据失败！");t.$http.get("roles").then((function(r){if(200!==r.data.meta.status)return t.$message.error("获取用户数据失败！");t.rolesList=r.data.data,t.userInfo=e.data.data,t.showAssignRoleForm=!0;var n=!0,o=!1,i=void 0;try{for(var s,a=r.data.data[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var l=s.value;l.id===t.userInfo.rid&&(t.userInfo.roleName=l.roleName)}}catch(u){o=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}})).catch((function(e){return e}))})).catch((function(e){return e}))})),s(n,"confirmRole",(function(){var e=this;this.$http.put("users/"+this.userInfo.id+"/role",{rid:this.selectedRoleId}).then((function(t){if(200!==t.data.meta.status)return e.$message.error(t.data.meta.msg);e.showAssignRoleForm=!1,e.$message.success(t.data.meta.msg),e.getUserList()})).catch((function(e){return e}))})),s(n,"handleSizeChange",(function(e){this.queryInfo.pagesize=e,this.getUserList()})),s(n,"handleCurrentChange",(function(e){console.log("当前页: ".concat(e)),this.queryInfo.pagenum=e,this.getUserList()})),n)},l=a,u=(r("11b9"),r("2877")),c=Object(u["a"])(l,o,i,!1,null,"0a2bf657",null);t["default"]=c.exports},"11b9":function(e,t,r){"use strict";var n=r("8802"),o=r.n(n);o.a},"3ca3":function(e,t,r){"use strict";var n=r("6547").charAt,o=r("69f3"),i=r("7dd0"),s="String Iterator",a=o.set,l=o.getterFor(s);i(String,"String",(function(e){a(this,{type:s,string:String(e),index:0})}),(function(){var e,t=l(this),r=t.string,o=t.index;return o>=r.length?{value:void 0,done:!0}:(e=n(r,o),t.index+=e.length,{value:e,done:!1})}))},6547:function(e,t,r){var n=r("a691"),o=r("1d80"),i=function(e){return function(t,r){var i,s,a=String(o(t)),l=n(r),u=a.length;return l<0||l>=u?e?"":void 0:(i=a.charCodeAt(l),i<55296||i>56319||l+1===u||(s=a.charCodeAt(l+1))<56320||s>57343?e?a.charAt(l):i:e?a.slice(l,l+2):s-56320+(i-55296<<10)+65536)}};e.exports={codeAt:i(!1),charAt:i(!0)}},"746f":function(e,t,r){var n=r("428f"),o=r("5135"),i=r("e538"),s=r("9bf2").f;e.exports=function(e){var t=n.Symbol||(n.Symbol={});o(t,e)||s(t,e,{value:i.f(e)})}},8802:function(e,t,r){},a4d3:function(e,t,r){"use strict";var n=r("23e7"),o=r("da84"),i=r("d066"),s=r("c430"),a=r("83ab"),l=r("4930"),u=r("fdbf"),c=r("d039"),f=r("5135"),d=r("e8b5"),m=r("861d"),p=r("825a"),g=r("7b0b"),b=r("fc6a"),h=r("c04e"),v=r("5c6c"),y=r("7c73"),w=r("df75"),I=r("241c"),S=r("057f"),L=r("7418"),U=r("06cf"),$=r("9bf2"),k=r("d1e7"),x=r("9112"),C=r("6eeb"),_=r("5692"),q=r("f772"),R=r("d012"),A=r("90e3"),O=r("b622"),F=r("e538"),T=r("746f"),E=r("d44e"),P=r("69f3"),z=r("b727").forEach,j=q("hidden"),N="Symbol",M="prototype",V=O("toPrimitive"),D=P.set,G=P.getterFor(N),B=Object[M],H=o.Symbol,J=i("JSON","stringify"),Z=U.f,Q=$.f,W=S.f,K=k.f,X=_("symbols"),Y=_("op-symbols"),ee=_("string-to-symbol-registry"),te=_("symbol-to-string-registry"),re=_("wks"),ne=o.QObject,oe=!ne||!ne[M]||!ne[M].findChild,ie=a&&c((function(){return 7!=y(Q({},"a",{get:function(){return Q(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=Z(B,t);n&&delete B[t],Q(e,t,r),n&&e!==B&&Q(B,t,n)}:Q,se=function(e,t){var r=X[e]=y(H[M]);return D(r,{type:N,tag:e,description:t}),a||(r.description=t),r},ae=u?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof H},le=function(e,t,r){e===B&&le(Y,t,r),p(e);var n=h(t,!0);return p(r),f(X,n)?(r.enumerable?(f(e,j)&&e[j][n]&&(e[j][n]=!1),r=y(r,{enumerable:v(0,!1)})):(f(e,j)||Q(e,j,v(1,{})),e[j][n]=!0),ie(e,n,r)):Q(e,n,r)},ue=function(e,t){p(e);var r=b(t),n=w(r).concat(pe(r));return z(n,(function(t){a&&!fe.call(r,t)||le(e,t,r[t])})),e},ce=function(e,t){return void 0===t?y(e):ue(y(e),t)},fe=function(e){var t=h(e,!0),r=K.call(this,t);return!(this===B&&f(X,t)&&!f(Y,t))&&(!(r||!f(this,t)||!f(X,t)||f(this,j)&&this[j][t])||r)},de=function(e,t){var r=b(e),n=h(t,!0);if(r!==B||!f(X,n)||f(Y,n)){var o=Z(r,n);return!o||!f(X,n)||f(r,j)&&r[j][n]||(o.enumerable=!0),o}},me=function(e){var t=W(b(e)),r=[];return z(t,(function(e){f(X,e)||f(R,e)||r.push(e)})),r},pe=function(e){var t=e===B,r=W(t?Y:b(e)),n=[];return z(r,(function(e){!f(X,e)||t&&!f(B,e)||n.push(X[e])})),n};if(l||(H=function(){if(this instanceof H)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=A(e),r=function(e){this===B&&r.call(Y,e),f(this,j)&&f(this[j],t)&&(this[j][t]=!1),ie(this,t,v(1,e))};return a&&oe&&ie(B,t,{configurable:!0,set:r}),se(t,e)},C(H[M],"toString",(function(){return G(this).tag})),C(H,"withoutSetter",(function(e){return se(A(e),e)})),k.f=fe,$.f=le,U.f=de,I.f=S.f=me,L.f=pe,F.f=function(e){return se(O(e),e)},a&&(Q(H[M],"description",{configurable:!0,get:function(){return G(this).description}}),s||C(B,"propertyIsEnumerable",fe,{unsafe:!0}))),n({global:!0,wrap:!0,forced:!l,sham:!l},{Symbol:H}),z(w(re),(function(e){T(e)})),n({target:N,stat:!0,forced:!l},{for:function(e){var t=String(e);if(f(ee,t))return ee[t];var r=H(t);return ee[t]=r,te[r]=t,r},keyFor:function(e){if(!ae(e))throw TypeError(e+" is not a symbol");if(f(te,e))return te[e]},useSetter:function(){oe=!0},useSimple:function(){oe=!1}}),n({target:"Object",stat:!0,forced:!l,sham:!a},{create:ce,defineProperty:le,defineProperties:ue,getOwnPropertyDescriptor:de}),n({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:me,getOwnPropertySymbols:pe}),n({target:"Object",stat:!0,forced:c((function(){L.f(1)}))},{getOwnPropertySymbols:function(e){return L.f(g(e))}}),J){var ge=!l||c((function(){var e=H();return"[null]"!=J([e])||"{}"!=J({a:e})||"{}"!=J(Object(e))}));n({target:"JSON",stat:!0,forced:ge},{stringify:function(e,t,r){var n,o=[e],i=1;while(arguments.length>i)o.push(arguments[i++]);if(n=t,(m(t)||void 0!==e)&&!ae(e))return d(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!ae(t))return t}),o[1]=t,J.apply(null,o)}})}H[M][V]||x(H[M],V,H[M].valueOf),E(H,N),R[j]=!0},d28b:function(e,t,r){var n=r("746f");n("iterator")},ddb0:function(e,t,r){var n=r("da84"),o=r("fdbc"),i=r("e260"),s=r("9112"),a=r("b622"),l=a("iterator"),u=a("toStringTag"),c=i.values;for(var f in o){var d=n[f],m=d&&d.prototype;if(m){if(m[l]!==c)try{s(m,l,c)}catch(g){m[l]=c}if(m[u]||s(m,u,f),o[f])for(var p in i)if(m[p]!==i[p])try{s(m,p,i[p])}catch(g){m[p]=i[p]}}}},e01a:function(e,t,r){"use strict";var n=r("23e7"),o=r("83ab"),i=r("da84"),s=r("5135"),a=r("861d"),l=r("9bf2").f,u=r("e893"),c=i.Symbol;if(o&&"function"==typeof c&&(!("description"in c.prototype)||void 0!==c().description)){var f={},d=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof d?new c(e):void 0===e?c():c(e);return""===e&&(f[t]=!0),t};u(d,c);var m=d.prototype=c.prototype;m.constructor=d;var p=m.toString,g="Symbol(test)"==String(c("test")),b=/^Symbol\((.*)\)[^)]+$/;l(m,"description",{configurable:!0,get:function(){var e=a(this)?this.valueOf():this,t=p.call(e);if(s(f,e))return"";var r=g?t.slice(7,-1):t.replace(b,"$1");return""===r?void 0:r}}),n({global:!0,forced:!0},{Symbol:d})}},e538:function(e,t,r){var n=r("b622");t.f=n},fdbc:function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}}}]);
//# sourceMappingURL=chunk-49d8d01a.b11e3e71.js.map